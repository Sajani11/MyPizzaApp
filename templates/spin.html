{% extends "layout.html" %} {% block content %}
<h2 style="text-align: center; font-family: Arial, sans-serif; color: #333">
  🎁 Spin the Reward Wheel 🎁
</h2>

<div id="wheel-container">
  {% if message %}
  <!-- Case 1: Already spun today -->
  <div
    id="result"
    style="margin-bottom: 20px; font-size: 18px; font-weight: bold"
  >
    {{ message }}
  </div>
  <a href="{{ redirect_after_spin }}" class="btn btn-success">
    Continue to Payment
  </a>
  {% else %}
  <!-- Case 2: First spin -->
  <div id="wheel">
    <div class="segment" style="transform: rotate(36deg)">
      <span class="segment-label">Free Delivery</span>
    </div>
    <div class="segment" style="transform: rotate(108deg)">
      <span class="segment-label">10% Off</span>
    </div>
    <div class="segment" style="transform: rotate(180deg)">
      <span class="segment-label">Extra Cheese</span>
    </div>
    <div class="segment" style="transform: rotate(252deg)">
      <span class="segment-label">No Reward</span>
    </div>
    <div class="segment" style="transform: rotate(324deg)">
      <span class="segment-label">Buy 1 Get 1</span>
    </div>
    <div id="pointer"></div>
  </div>
  <button id="spin-btn" class="btn btn-primary">Spin Now</button>
  <div id="result"></div>
  {% endif %}
</div>

<!-- Pass the redirect URL to JS -->
<script>
  window.redirectAfterSpin = "{{ redirect_after_spin }}";
</script>

{% if not message %}
<!-- Only load spin.js if the user hasn’t spun yet -->
<script src="{{ url_for('static', filename='spin.js') }}"></script>
{% endif %} {% endblock %}
